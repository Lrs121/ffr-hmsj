#  Copyright 2019 Nicole Borrelli
#
#  Licensed under the Apache License, Version 2.0 (the "License");
#  you may not use this file except in compliance with the License.
#  You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.

# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
#
# Key Item Location scripts
#
# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

king_event = """
    db 0x60 0x4 0x0 0xff
    db 0x9 0x4 0x23 0x0
    db 0x1f 0x4 0x5 0x6
    db 0x9 0x4 0xa 0x0
    db 0x1f 0x4 0x5 0x0
    db 0x9 0x4 0x14 0x0
    music 0x0 0x8e
    db 0x23 0xc 0xff 0x5 0x8 0x0 0xf0 0xff 0xb4 0x0 0x88 0x1
    db 0x9 0x4 0x78 0x0
    db 0x9 0x4 0x3c 0x0
    db 0x2b 0x4 0x0 0xff
    db 0x14 0x4 0x5 0x0
    db 0x16 0x4 0x0 0xff
    db 0x12 0xc 0x0 0x0 0x2 0xff 0x26 0x0 0x1d 0x0 0xff 0xff
    db 0x1f 0x4 0x20 0x2
    db 0x15 0x8 0x1 0x1 0x1 0x0 0x0 0x0
    db 0x3b 0x4 0xff 0xff
    set_flag 0x1
    db 0x1b 0x8 0x3 0x3 0xff 0xff 0x20 0xff
    db 0x9 0x4 0x23 0x0
    db 0x15 0x8 0x2 0x0 0x1 0x0 0x0 0x0
    db 0x3b 0x4 0xff 0xff
    db 0x3b 0x4 0xff 0xff
    db 0x12 0xc 0x1 0x0 0x2 0xff 0x26 0x0 0x1d 0x0 0xff 0xff
    db 0x12 0xc 0x3 0x0 0x2 0xff 0x26 0x0 0x1d 0x0 0xff 0xff
    db 0x12 0xc 0x2 0x0 0x2 0xff 0x26 0x0 0x1d 0x0 0xff 0xff
    db 0x20 0x4 0x21 0xff
    db 0x20 0x4 0x22 0xff
    db 0x20 0x4 0x23 0xff
    db 0xb 0xc 0x1 0x3 0x3 0x0 0x0 0x0 0x21 0x0 0xff 0xff
    db 0xb 0xc 0x1 0x3 0x2 0x0 0x0 0x0 0x22 0x0 0xff 0xff
    db 0xb 0xc 0x1 0x3 0x0 0x0 0x0 0x0 0x23 0x0 0xff 0xff
    db 0x4 0x4 0xff 0xff
    db 0x1f 0x4 0x21 0x2
    db 0x1f 0x4 0x22 0x2
    db 0x1f 0x4 0x23 0x2
    db 0x9 0x4 0x23 0x0
    db 0x21 0x4 0x20 0x1
    db 0x21 0x4 0x21 0x1
    db 0x21 0x4 0x22 0x1
    db 0x21 0x4 0x23 0x1
    db 0x20 0x4 0x20 0xff
    db 0x20 0x4 0x21 0xff
    db 0x20 0x4 0x22 0xff
    db 0x20 0x4 0x23 0xff
    db 0xb 0xc 0x1 0x3 0x1 0x0 0x0 0x0 0x21 0x0 0xff 0xff
    db 0xb 0xc 0x1 0x3 0x1 0x0 0x0 0x0 0x22 0x0 0xff 0xff
    db 0x4 0x4 0xff 0xff
    db 0xb 0xc 0x1 0x3 0x3 0x0 0x0 0x0 0x20 0x0 0xff 0xff
    db 0x4 0x4 0xff 0xff
    db 0xb 0xc 0x1 0x3 0x1 0x0 0x0 0x0 0x23 0x0 0xff 0xff
    db 0x4 0x4 0xff 0xff
    db 0x1f 0x4 0x20 0x4
    db 0x1f 0x4 0x21 0x4
    db 0x1f 0x4 0x22 0x6
    db 0x20 0x4 0x23 0xff
    db 0xb 0xc 0x1 0x3 0x2 0x0 0x0 0x0 0x23 0x0 0xff 0xff
    db 0x4 0x4 0xff 0xff
    db 0x1f 0x4 0x23 0x6
    db 0x9 0x4 0x3c 0x0
    db 0x20 0x4 0x6 0xff
    music 0x0 0x8e
    db 0x23 0xc 0xff 0x6 0x8 0x0 0xf0 0xff 0xb4 0x0 0x88 0x1
    db 0x9 0x4 0x3c 0x0
    db 0x9 0x4 0x23 0x0
    db 0x9 0x4 0x28 0x0
    db 0x1f 0x4 0x20 0x0
    db 0x1f 0x4 0x21 0x0
    db 0x1f 0x4 0x22 0x0
    db 0x1f 0x4 0x23 0x0
    db 0x9 0x4 0x23 0x0
    db 0x1f 0x4 0x20 0x10
    db 0x1f 0x4 0x21 0x10
    db 0x1f 0x4 0x22 0x10
    db 0x1f 0x4 0x23 0x10
    db 0x9 0x4 0x28 0x0
    db 0x1f 0x4 0x20 0x0
    db 0x1f 0x4 0x21 0x0
    db 0x1f 0x4 0x22 0x0
    db 0x1f 0x4 0x23 0x0
    db 0x9 0x4 0x3c 0x0
    music 0x5 0x8
    db 0x1b 0x8 0x0 0x3 0xff 0xff 0x20 0xff
    db 0x9 0x4 0x3c 0x0
    music 0x6 0xffff
    db 0x3 0xc 0x1 0x39 0x14 0x0 0x8 0x0 0x0 0x1 0xff 0xff
    db 0x16 0x4 0x0 0xff
    db 0x12 0xc 0x0 0x0 0x2 0xff 0x14 0x0 0x9 0x0 0xff 0xff
    db 0x12 0xc 0x1 0x0 0x2 0xff 0x13 0x0 0xa 0x0 0xff 0xff
    db 0x12 0xc 0x2 0x0 0x2 0xff 0x14 0x0 0xa 0x0 0xff 0xff
    db 0x12 0xc 0x3 0x0 0x2 0xff 0x15 0x0 0xa 0x0 0xff 0xff
    db 0x1f 0x4 0x20 0x2
    db 0x1f 0x4 0x21 0x2
    db 0x1f 0x4 0x22 0x2
    db 0x1f 0x4 0x23 0x2
    db 0x15 0x8 0x1 0x4 0x1 0x0 0x0 0x0
    db 0x3b 0x4 0xff 0xff
    db 0x3b 0x4 0xff 0xff
    db 0x1b 0x8 0x1 0x3 0xff 0xff 0x20 0xff
    db 0x9 0x4 0x3c 0x0
    db 0x9 0x4 0x28 0x0
    db 0x9 0x4 0x3c 0x0
    music 0x5 0x2           ; Fade BGM (fast)
    music 0xa 0xffff        ; Wait for fade
    load_text top %text_id
    music 0x0 0x21          ; Play fanfare
    show_dialog
    music 0x9 0xffff        ; Wait for fanfare to finish
    close_dialog wait
    music 0x4 0x4           ; Resume BGM
    db 0x20 0x4 0x21 0xff
    db 0x20 0x4 0x23 0xff
    db 0xb 0xc 0x1 0x3 0x1 0x0 0x0 0x0 0x21 0x0 0xff 0xff
    db 0xb 0xc 0x1 0x3 0x1 0x0 0x0 0x0 0x23 0x0 0xff 0xff
    db 0x4 0x4 0xff 0xff
    db 0x20 0x4 0x22 0xff
    db 0xb 0xc 0x1 0x3 0x2 0x0 0x0 0x0 0x21 0x0 0xff 0xff
    db 0xb 0xc 0x1 0x3 0x1 0x0 0x0 0x0 0x22 0x0 0xff 0xff
    db 0xb 0xc 0x1 0x3 0x3 0x0 0x0 0x0 0x23 0x0 0xff 0xff
    db 0x4 0x4 0xff 0xff
    db 0x14 0x4 0x1 0x1
    db 0x14 0x4 0x2 0x1
    db 0x14 0x4 0x3 0x1
    db 0x15 0x8 0x2 0x0 0x0 0x0 0x0 0x0
    db 0x3b 0x4 0xff 0xff
    db 0x3b 0x4 0xff 0xff
    db 0x26 0x4 0x1 0xff
    db 0x16 0x4 0x1 0xff
    db 0x14 0x4 0x0 0x1
    set_npc_event 0x2 0x1f5c
    GIVE_REWARD
    db 0x6a 0x8 0xff 0x7f 0xff 0xff 0xff 0xff
    db 0x6a 0x8 0xe 0x0 0x0 0xff 0xff 0xff
    db 0x6a 0x8 0x0 0x0 0x38 0xff 0xff 0xff
    end_event
"""

sara_event = """
    db 0x60 0x4 0x1 0xff
    jump .Label_1
    db 0x60 0x4 0x1 0xff
    db 0x26 0x4 0x1 0xff
    db 0x9 0x4 0x1e 0x0
    db 0x15 0x8 0x1 0x3 0x1 0x0 0x0 0x0
    db 0x3b 0x4 0xff 0xff
    db 0x15 0x8 0x1 0x3 0x3 0x0 0x0 0x0
    db 0x3b 0x4 0xff 0xff
    db 0x26 0x4 0x1 0xff
    db 0x9 0x4 0x1e 0x0
    .Label_1:
    db 0x9 0x4 0xa 0x0
    db 0x26 0x4 0x0 0xff
    db 0x12 0x8 0x0 0x1 0x2 0xff 0xff 0xff
    db 0x16 0x4 0x0 0xff
    db 0x9 0x4 0xa 0x0
    db 0x1f 0x4 0x20 0x10
    db 0x9 0x4 0x1e 0x0
    db 0x1f 0x4 0x20 0x0
    music 0x5 0x2           ; Fade BGM (fast)
    music 0xa 0xffff        ; Wait for fade
    load_text top %text_id
    music 0x0 0x21          ; Play fanfare
    show_dialog
    music 0x9 0xffff        ; Wait for fanfare to finish
    close_dialog wait
    music 0x4 0x4           ; Resume BGM
    db 0x16 0x4 0x1 0xff
    db 0x14 0x4 0x0 0x1
    GIVE_REWARD
    db 0x1 0x4 0xff 0xff
    db 0x60 0x4 0x0 0xff
    set_npc_event 0x3 0x1f5d
    remove_trigger 0x13cb
    end_event
"""

# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
#
# Map Events
#
# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

cornelia_castle_2f_event = """
    remove_all 0x138c
    db 0x1f 0x4 0x2 0x0
    check_flag 0x1 jnz .Label_3
    remove_trigger 0x1f5d
    jump .Label_4
    .Label_3:
    check_flag %reward_flag jnz .Label_4
    set_npc_event 0x3 0x13a7
    db 0x2f 0x8 0xcb 0x13 0xff 0x14 0xa 0x8
    .Label_4:
    end_event
"""

# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
#
# Key Item Reward snippets
#
# * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

lute_reward = """
%text_id 0x10a
%reward_flag 0x04

#define GIVE_REWARD \\
    set_flag 0x4                    ; Lute obtained \\
    give_item 0x0                   ; Lute key item
"""

lufienish_reward = """
%text_id 0x235
%reward_flag 0x1e

#define GIVE_REWARD set_flag 0x1e   ; Can speak Lufienish 
"""