<!doctype html>
<html itemscope="" itemtype="http://schema.org/WebPage" lang="en">
<head>
  <meta charset="utf-8">
  <title>Final Fantasy Randomizer: HMS Jayne</title>
  <style type="text/css">
    #flags {
      display: inline-block;
    }
    #flags label {
      display: block;
      text-align: left;
    }
    label {
      margin: 4px 0px;
    }
    h1 {
      display: none;
    }
    body {
   	  background: #000;
   	  margin-left: auto;
   	  margin-right: auto;
  	  font-family: "Palatino Linotype", "Book Antiqua", Palatino, serif;
      font-size: 100%;
      color: GhostWhite;
      text-shadow: 2px 1px black;
      width: 720px;
    }
    div {
      border: solid 1px #424542;
      box-shadow: 3px 3px #e7dfe7,
                  -3px -3px #e7dfe7,
                  3px -3px #e7dfe7,
                  -3px 3px #e7dfe7,
                  0 -5px #9c9a9c,
                  -5px 0 #7b757b,
                  0 3px #424542;
      padding: 5px 10px;
      margin: 20px 0px;

      background: #04009d;
      background: -moz-linear-gradient(top,  #04009d 0%, #06004d 100%);
      background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#04009d), color-stop(100%,#06004d));
      background: -webkit-linear-gradient(top,  #04009d 0%,#06004d 100%);
      background: -o-linear-gradient(top,  #04009d 0%,#06004d 100%);
      background: -ms-linear-gradient(top,  #04009d 0%,#06004d 100%);
      background: linear-gradient(to bottom,  #04009d 0%,#06004d 100%);
      filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#04009d', endColorstr='#06004d',GradientType=0 );


      -webkit-border-radius: 7px;
      -moz-border-radius: 7px;
      border-radius: 7px;
    }
    div * {
      color: #eff1ff;
      text-shadow: 2px 2px #212421,
                   1px 1px #212021;
      font-family: monospace;
      font-size: 20px;
      font-weight: normal;
      margin: 5px 0;
    }
    input {
  	  font-size: 100%;
      margin: 4px 0px;
      background: none;
      padding: 3px;
    }
    input[type="file" i] {
  	  font-family: "Palatino Linotype", "Book Antiqua", Palatino, serif;
      font-size: 100%;
      color: GhostWhite;
      text-shadow: 2px 1px black;
      width: 100%;
    }
    input[type="checkbox" i] {
      display: inline-block;
      float: right;
      padding: 4px;
    }

    div.logo {
      background: white;
      border: none;
    }
    img.logo {
      width: 720px;
    }

    #exp-scale {
      vertical-align: middle;
    }

    #links {
      background: #049d00;
      background: -moz-linear-gradient(top,  #049d00 0%, #064d00 100%);
      background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#049d00), color-stop(100%,#064d00));
      background: -webkit-linear-gradient(top,  #049d00 0%,#064d00 100%);
      background: -o-linear-gradient(top,  #049d00 0%,#064d00 100%);
      background: -ms-linear-gradient(top,  #049d00 0%,#064d00 100%);
      background: linear-gradient(to bottom,  #049d00 0%,#064d00 100%);
      filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#049d00', endColorstr='#064d00',GradientType=0 );
    }
    #links a {
      text-decoration: none;
    }
    #links img {
      width: 64px;
      vertical-align: middle;
    }

  </style>
</head>
<body>
<h1>
  Final Fantasy Randomizer: HMS Jayne
</h1>

<img class="logo" src="hmslogo.jpg"/>

<div id="links">
  <a href="https://github.com/hmsjayne/ffr-hmsj/issues">
    <img src="github.png"/>
    Report an issue
  </a>
  <br/>
  <a id="discord" href="https://discord.gg/kPxkH5W">
    <img src="discord.png"/>
    Join the community
  </a>
</div>

<form method="post" enctype="multipart/form-data" action="randomize">
  <div>
    <h2>
      Select a <i>Final Fantasy I & II: Dawn of Souls</i> ROM to randomize:
    </h2>
    <label>
      Upload ROM:
      <input id="rom-file" name="rom" type="file" accept=".gba" style="display: none;" onchange="updateRom()">
      <input id="rom-button" type="button" value="Select ROM" onclick="document.getElementById('rom-file').click()">
    </label>
  </div>

  <div>
    <h2>
      Select options for the randomized ROM:
    </h2>

    <label>
      Flagstring: <span id="rom-flags"></span>
      <input id="rom-flags-input" name="flags" style="display: none;">
    </label>

    <br/>

    <div id="flags">
      <label>Shuffle Key Items: <input id="key-item" type="checkbox"/></label>
      <label>Encounter toggle: <input id="encounter-toggle" type="checkbox"/></label>
      <label>Magic shuffle: <input id="magic-shuffle" type="checkbox"/></label>
      <label>Treasure shuffle: <input id="treasure-shuffle" type="checkbox"/></label>
      <label>Random Treasures?: <input id="treasure-random" type="checkbox"/></label>
      <label>Wealth Level: 
          <input id="wealth" type="range" min="-1" max="1" value="0" step="1" class="slider">
      </label>
      <label>Formation shuffle: <input id="formation-shuffle" type="checkbox"/></label>
      <label>Exp Scale:
        <input id="exp-scale" type="range" min="50" max="500" value="150" step="10" class="slider">
      </label>
    </div>
  </div>

  <div>
    <h2>
      Optionally, enter a seed value:
    </h2>
    <label>
      Seed:
      <input id="rom-seed" name="seed" type="text" maxlength="10">
      <p>
        Seeds may be up to 10 ASCII characters long.
      </p>
    </label>
  </div>

  <div>
    <h2>
      Submit ROM:
    </h2>

    <input type="submit" value="Randomize">
  </div>

</form>
</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
<script type="text/javascript">
    function genSeed() {
      var seed = Math.floor(Math.random() * 0xffffffff).toString(16);
      if ($("#rom-seed").val().length == 0) {
        $("#rom-seed").val(seed);
      }
    }

    function updateRom() {
      var fullPath = document.getElementById('rom-file').value;
      if (fullPath) {
        var startIndex = (fullPath.indexOf('\\') >= 0 ? fullPath.lastIndexOf('\\') : fullPath.lastIndexOf('/'));
        var filename = fullPath.substring(startIndex);
        if (filename.indexOf('\\') === 0 || filename.indexOf('/') === 0) {
            filename = filename.substring(1);
        }
        document.getElementById("rom-button").value = filename;
      } else {
        document.getElementById("rom-button").value = "Select ROM"
      }
    }

    function updateFlags() {
      var flags = "";
      if ($("#key-item").prop("checked")) {
        flags += "K "
      }
      if ($("#encounter-toggle").prop("checked")) {
        flags += "Et "
      }
      if ($("#magic-shuffle").prop("checked")) {
        flags += "Ms "
      }
      if ($("#treasure-shuffle").prop("checked")) {
        if ($("#treasure-random").prop("checked")){
            wealth = document.getElementById("wealth");
            flags += "T" + parseInt(wealth.value) + " ";
        }
        else
          {
              flags += "Ts "
          }
        
      }
        else if ($("#treasure-random").prop("checked")){
            wealth = document.getElementById("wealth");
            flags += "T" + parseInt(wealth.value) + " ";
        }
      if ($("#formation-shuffle").prop("checked")) {
        flags += "Fs "
      }

      expScale = document.getElementById("exp-scale");
      flags += "XP=" + parseInt(expScale.value) / 100;
      flags = flags.trim();

      document.getElementById("rom-flags").textContent = flags;
      document.getElementById("rom-flags-input").value = flags;
    }

    $(document).ready(function() {
      genSeed();
      updateFlags();

      $("#rom-seed").blur(genSeed);

      $("#key-item").change(updateFlags);
      $("#encounter-toggle").change(updateFlags);
      $("#magic-shuffle").change(updateFlags);
      $("#treasure-shuffle").change(updateFlags);
      $("#treasure-random").change(updateFlags);
      $("#exp-scale").on("input change", updateFlags);
      $("#wealth").on("input change", updateFlags);
    });








</script>
</html>