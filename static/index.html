<!doctype html>
<html itemscope="" itemtype="http://schema.org/WebPage" lang="en">
<head>
  <meta charset="utf-8">
  <title>Final Fantasy Randomizer: HMS Jayne</title>
  <style type="text/css">
    #flags label {
      display: block;
    }


  </style>
</head>
<body onload="">
<h1>Final Fantasy Randomizer: HMS Jayne</h1>
<hr>
<form method="post" enctype="multipart/form-data" action="randomize">
  <div>
    <label>
      Flags:
      <input id="rom-flags" name="flags" type="text" tabindex="-1" readonly>
      Seed:
      <input id="rom-seed" name="seed" type="text" maxlength="10">
    </label>
  </div>

  <div>
    <h2>
      Select a <i>Final Fantasy I & II: Dawn of Souls</i> ROM to randomize:
    </h2>
    <label>Upload ROM</label><br/>
    <label>
      <input name="rom" type="file" accept=".gba">
    </label>
  </div>

  <div>
    <h2>
      Select options for the randomized ROM:
    </h2>

    <div id="flags">
      <label>Shuffle Key Items: <input id="key-item" type="checkbox"/></label>
      <label>Encounter toggle: <input id="encounter-toggle" type="checkbox"/></label>
      <label>Magic shuffle: <input id="magic-shuffle" type="checkbox"/></label>
      <label>Treasure shuffle: <input id="treasure-shuffle" type="checkbox"/></label>
      <label>Exp Scale:
        <input id="exp-scale" type="range" min="100" max="500" value="200" step="10" class="slider">
      </label>
    </div>
  </div>

  <div>
    <h2>
      Submit ROM:
    </h2>

    <input type="submit" value="Randomize">
  </div>

</form>
</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
<script type="text/javascript">
    function genSeed() {
      var seed = Math.floor(Math.random() * 0xffffffff).toString(16);
      if ($("#rom-seed").val().length == 0) {
        $("#rom-seed").val(seed);
      }
    }

    function updateFlags() {
      var flags = "";
      if ($("#key-item").prop("checked")) {
        flags += "K "
      }
      if ($("#encounter-toggle").prop("checked")) {
        flags += "Et "
      }
      if ($("#magic-shuffle").prop("checked")) {
        flags += "Ms "
      }
      if ($("#treasure-shuffle").prop("checked")) {
        flags += "Ts "
      }
      flags += "XP=" + ($("#exp-scale").val() / 100);
      $("#rom-flags").val(flags.trim());
    }

    $(document).ready(function() {
      genSeed();
      updateFlags();

      $("#rom-seed").blur(genSeed);

      $("#key-item").change(updateFlags);
      $("#encounter-toggle").change(updateFlags);
      $("#magic-shuffle").change(updateFlags);
      $("#treasure-shuffle").change(updateFlags);
      $("#exp-scale").on("input change", updateFlags);
    });



</script>
</html>